<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Van Elst Werkbon</title>
    
    <link rel="icon" type="image/png" href="https://i.postimg.cc/8z7mN6v4/17710072555007831206522644441979.png">
    <link rel="apple-touch-icon" href="https://i.postimg.cc/8z7mN6v4/17710072555007831206522644441979.png">
    <meta name="apple-mobile-web-app-title" content="Van Elst">
    <meta name="mobile-web-app-capable" content="yes">

    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; padding: 10px; color: #333; }
        .container { max-width: 650px; margin: auto; display: none; }
        .login-container { max-width: 350px; margin: 80px auto; text-align: center; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .logo-header { text-align: center; margin-bottom: 20px; }
        .logo-header img { max-width: 220px; height: auto; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 20px; border-top: 4px solid #2d4d36; }
        h2 { margin-top: 0; color: #2d4d36; border-bottom: 1px solid #eee; padding-bottom: 10px; font-size: 1.1em; text-transform: uppercase; letter-spacing: 1px; }
        label { display: block; margin-top: 12px; font-weight: 600; font-size: 0.85em; color: #444; }
        input, textarea, select { width: 100%; padding: 12px; margin-top: 5px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 16px; background: #fff; }
        input:focus { border-color: #2d4d36; outline: none; box-shadow: 0 0 5px rgba(45,77,54,0.2); }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
        .totaal-box { background: #f0f4f1; padding: 12px; border-radius: 8px; margin-top: 15px; text-align: center; font-weight: bold; color: #2d4d36; border: 1px solid #dce6de; }
        .btn-send { background: #2d4d36; color: white; border: none; padding: 18px; width: 100%; border-radius: 10px; font-size: 18px; font-weight: bold; cursor: pointer; margin-top: 15px; transition: 0.3s; }
        .btn-send:active { background: #1e3324; transform: scale(0.98); }
        .btn-locatie { background: #6c757d; color: white; border: none; padding: 12px; border-radius: 8px; font-size: 14px; margin-top: 8px; cursor: pointer; width: 100%; font-weight: bold; }
        .klant-header { background: #2d4d36; padding: 5px 15px; border-radius: 20px; font-weight: bold; color: white; margin-bottom: 15px; font-size: 0.9em; display: inline-block; }
        hr { border: 0; border-top: 1px solid #eee; margin: 20px 0; }
    </style>
</head>
<body>

<div id="login-box" class="login-container">
    <div class="logo-header">
        <img src="https://i.postimg.cc/8z7mN6v4/17710072555007831206522644441979.png" alt="Van Elst">
    </div>
    <h2 style="border:none;">Beveiligde Toegang</h2>
    <input type="password" id="pincode" placeholder="Toegangscode" style="text-align:center; margin-bottom:15px; letter-spacing: 5px;">
    <button class="btn-send" onclick="checkCode()">INLOGGEN</button>
</div>

<div id="app-content" class="container">
    <div class="logo-header">
        <img src="https://i.postimg.cc/8z7mN6v4/17710072555007831206522644441979.png" alt="Van Elst">
    </div>

    <div class="card">
        <h2>Dagoverzicht Medewerker</h2>
        <label>Naam Medewerker</label>
        <input type="text" id="medewerker" value="Vincent Claassen">
        
        <div class="grid-3">
            <div><label>Start Dag</label><input type="time" id="dag_start" onchange="berekenDagUren()"></div>
            <div><label>Einde Dag</label><input type="time" id="dag_eind" onchange="berekenDagUren()"></div>
            <div><label>Pauze (min)</label><input type="number" id="dag_pauze" value="0" onchange="berekenDagUren()"></div>
        </div>
        <div class="totaal-box">Netto gewerkte tijd: <span id="totaalDagUren">0:00</span></div>
    </div>

    <div id="klanten-container"></div>

    <div class="card">
        <button class="btn-send" onclick="verstuurMail()">üìß WERKBON VERSTUREN</button>
    </div>
</div>

<script>
    function checkCode() {
        if (document.getElementById('pincode').value === "1234") {
            document.getElementById('login-box').style.display = 'none';
            document.getElementById('app-content').style.display = 'block';
            window.scrollTo(0,0);
        } else { alert("Onjuiste code!"); }
    }

    const container = document.getElementById('klanten-container');
    for (let i = 1; i <= 5; i++) {
        container.innerHTML += `
            <div class="card">
                <div class="klant-header">KLANT ${i}</div>
                <label>Klantnaam / Project</label><input type="text" id="klant_naam_${i}">
                <label>Locatie</label><input type="text" id="klant_locatie_${i}">
                <button class="btn-locatie" onclick="geolocate(${i})">üìç Huidige Locatie Gebruiken</button>
                <label>Werkzaamheden</label><textarea id="klant_werk_${i}" rows="2" placeholder="Wat heb je gedaan?"></textarea>
                <div class="grid-3">
                    <div><label>Begintijd</label><input type="time" id="k_start_${i}" onchange="berekenKlantUren(${i})"></div>
                    <div><label>Eindtijd</label><input type="time" id="k_eind_${i}" onchange="berekenKlantUren(${i})"></div>
                    <div><label>Pauze (min)</label><input type="number" id="k_pauze_${i}" value="0" onchange="berekenKlantUren(${i})"></div>
                </div>
                <div class="totaal-box">Uren op dit project: <span id="totaal_k_${i}">0:00</span></div>
                <hr>
                <div class="grid-2">
                    <div><label>Machine</label><input type="text" id="machine_${i}" placeholder="Bijv. Kraan"></div>
                    <div><label>Wachttijd / Defect</label>
                        <div style="display:flex;"><input type="number" id="w_tijd_${i}" style="width:55%;"><select id="w_type_${i}" style="width:45%;"><option>Wachten</option><option>Defect</option></select></div>
                    </div>
                </div>
                <div class="grid-2">
                    <div><label>Laden</label><div style="display:flex;"><input type="number" id="l_h_${i}"><select id="l_e_${i}"><option>m3</option><option>Ton</option><option>Stuks</option></select></div></div>
                    <div><label>Lossen</label><div style="display:flex;"><input type="number" id="lo_h_${i}"><select id="lo_e_${i}"><option>m3</option><option>Ton</option><option>Stuks</option></select></div></div>
                </div>
                <div style="background:#fff3cd; padding:15px; margin-top:15px; border-radius:10px; border:1px dashed #e6c200;">
                    <label style="margin-top:0;">üì∏ Foto van het werk</label><input type="file" id="foto_${i}" accept="image/*" capture="camera">
                </div>
            </div>
        `;
    }

    function geolocate(i) {
        if (!navigator.geolocation) return;
        const target = document.getElementById(`klant_locatie_${i}`);
        target.value = "Locatie ophalen...";
        navigator.geolocation.getCurrentPosition(async (pos) => {
            try {
                const resp = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${pos.coords.latitude}&lon=${pos.coords.longitude}&format=json`);
                const data = await resp.json();
                target.value = data.display_name.split(',').slice(0, 3).join(',');
            } catch { target.value = pos.coords.latitude.toFixed(4) + "," + pos.coords.longitude.toFixed(4); }
        }, () => { alert("GPS toegang geweigerd."); target.value = ""; });
    }

    function berekenTijd(s, e, p) {
        if (!s || !e) return "0:00";
        let min = (parseInt(e.split(':')[0])*60 + parseInt(e.split(':')[1])) - (parseInt(s.split(':')[0])*60 + parseInt(s.split(':')[1])) - p;
        return Math.max(0, Math.floor(min/60)) + ":" + (min%60 < 10 ? '0':'') + Math.max(0, min%60);
    }
    function berekenDagUren() { document.getElementById('totaalDagUren').innerText = berekenTijd(document.getElementById('dag_start').value, document.getElementById('dag_eind').value, parseInt(document.getElementById('dag_pauze').value) || 0); }
    function berekenKlantUren(i) { document.getElementById(`totaal_k_${i}`).innerText = berekenTijd(document.getElementById(`k_start_${i}`).value, document.getElementById(`k_eind_${i}`).value, parseInt(document.getElementById(`k_pauze_${i}`).value) || 0); }

    function verstuurMail() {
        let klantData = "";
        for (let i = 1; i <= 5; i++) {
            let n = document.getElementById(`klant_naam_${i}`).value;
            if (n) {
                klantData += `KLANT ${i}: ${n}\nLocatie: ${document.getElementById(`klant_locatie_${i}`).value}\nWerk: ${document.getElementById(`klant_werk_${i}`).value}\nUren: ${document.getElementById(`totaal_k_${i}`).innerText}\nMachine: ${document.getElementById(`machine_${i}`).value} (${document.getElementById(`w_tijd_${i}`).value || 0}m ${document.getElementById(`w_type_${i}`).value})\nLaden: ${document.getElementById(`l_h_${i}`).value || 0}${document.getElementById(`l_e_${i}`).value} / Lossen: ${document.getElementById(`lo_h_${i}`).value || 0}${document.getElementById(`lo_e_${i}`).value}\n\n`;
            }
        }
        const med = document.getElementById('medewerker').value;
        const dagTotaal = document.getElementById('totaalDagUren').innerText;
        const body = `WERKBON VAN ELST\n\nMedewerker: ${med}\nNetto dagtijd: ${dagTotaal}\n\n${klantData}`;
        window.location.href = `mailto:info@jouwbedrijf.nl?subject=Werkbon ${med}&body=${encodeURIComponent(body)}`;
    }
</script>
</body>
</html>

